<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V√≤ng ƒê·ªùi & T·∫°o API ASP.NET Core Web API cho Ng∆∞·ªùi M·ªõi B·∫Øt ƒê·∫ßu</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 25px;
        }
        h1 {
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.05);
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e6ec;
        }
        h2 {
            font-size: 2.2em;
            color: #34495e;
            margin-top: 40px;
            border-left: 6px solid #4a90e2;
            padding-left: 15px;
            text-align: left;
        }
        h3 {
            font-size: 1.6em;
            color: #555;
            margin-top: 30px;
            text-align: left;
        }
        h4 {
            font-size: 1.3em;
            color: #4a90e2;
            margin-top: 25px;
            text-align: left;
        }
        .section-description {
            margin-bottom: 20px;
            color: #555;
            text-align: left;
        }
        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            border-left: 5px solid #61afef;
        }
        .code-block code {
            display: block;
            white-space: pre-wrap;
        }
        .highlight {
            color: #c678dd; /* Purple */
        }
        .comment {
            color: #5c6370; /* Gray */
        }
        .keyword {
            color: #e06c75; /* Reddish */
        }
        .string {
            color: #98c379; /* Green */
        }
        .number {
            color: #d19a66; /* Orange */
        }
        .diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 40px 0;
            gap: 15px;
        }
        .stage {
            background: #e9ecef;
            border: 2px solid #adb5bd;
            border-radius: 8px;
            padding: 15px 25px;
            text-align: center;
            font-weight: bold;
            color: #343a40;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            min-width: 250px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .stage:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        .arrow {
            font-size: 2em;
            color: #4a90e2;
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        ul li {
            background: #f8f9fa;
            margin-bottom: 10px;
            padding: 12px 20px;
            border-left: 4px solid #4a90e2;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        ul li strong {
            color: #34495e;
        }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 25px;
            border-radius: 8px;
            color: #664d03;
        }
        .step-by-step {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .step {
            background: #e6f3ff;
            border: 1px solid #a8d5ff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .step strong {
            color: #1a73e8;
            font-size: 1.1em;
        }
        .rest-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .method-box {
            background: #e9f5e9;
            border-left: 5px solid #4CAF50;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        .method-box.get { border-left-color: #2196F3; background: #e3f2fd; }
        .method-box.post { border-left-color: #FFC107; background: #fffde7; }
        .method-box.put { border-left-color: #9C27B0; background: #f3e5f5; }
        .method-box.delete { border-left-color: #F44336; background: #ffebee; }
        .method-box h4 {
            text-align: left;
            margin-top: 0;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ V√≤ng ƒê·ªùi & T·∫°o API ASP.NET Core Web API</h1>
        <p class="section-description" style="text-align: center;">
            Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi th·∫ø gi·ªõi c·ªßa Web API! H∆∞·ªõng d·∫´n n√†y s·∫Ω gi√∫p b·∫°n hi·ªÉu r√µ c√°ch m·ªôt ·ª©ng d·ª•ng ASP.NET Core Web API ho·∫°t ƒë·ªông t·ª´ A ƒë·∫øn Z, v√† c√°ch x√¢y d·ª±ng m·ªôt API ƒë∆°n gi·∫£n.
        </p>

        ---

        <h2>Ph·∫ßn 1: Hi·ªÉu V√≤ng ƒê·ªùi ·ª®ng D·ª•ng ASP.NET Core Web API</h2>
        <p class="section-description">
            M·ªôt ·ª©ng d·ª•ng Web API trong ASP.NET Core kh√¥ng ch·ªâ l√† code c·ªßa b·∫°n. N√≥ l√† m·ªôt h·ªá th·ªëng ph·ª©c t·∫°p v·ªõi nhi·ªÅu "b√°nh rƒÉng" quay c√πng nhau. H√£y xem c√°ch m·ªôt y√™u c·∫ßu (request) t·ª´ tr√¨nh duy·ªát ho·∫∑c ·ª©ng d·ª•ng kh√°c ƒë∆∞·ª£c x·ª≠ l√Ω t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi.
        </p>

        <h3>1.1. S∆° ƒê·ªì T·ªïng Quan V√≤ng ƒê·ªùi</h3>
        <p class="section-description">
            H√£y h√¨nh dung m·ªôt y√™u c·∫ßu HTTP (v√≠ d·ª•: khi b·∫°n g√µ m·ªôt ƒë·ªãa ch·ªâ web ho·∫∑c click m·ªôt n√∫t tr√™n ·ª©ng d·ª•ng) ƒëi qua c√°c t·∫ßng c·ªßa ·ª©ng d·ª•ng Web API c·ªßa b·∫°n:
        </p>
        
        <div class="diagram">
            <div class="stage">Browser/Client G·ª≠i HTTP Request (Y√™u c·∫ßu)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">Kestrel/IIS (Server) Nh·∫≠n Request</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">Middleware Pipeline B·∫Øt ƒê·∫ßu</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">UseHttpsRedirection() <br> (Chuy·ªÉn h∆∞·ªõng an to√†n)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">UseRouting() <br> (T√¨m ƒë∆∞·ªùng cho Request)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">UseCors() <br> (Ki·ªÉm tra ngu·ªìn g·ªëc Request)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">UseAuthentication() <br> (X√°c ƒë·ªãnh b·∫°n l√† ai)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">UseAuthorization() <br> (B·∫°n c√≥ quy·ªÅn l√†m g√¨?)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">MapControllers() <br> (Chuy·ªÉn Request ƒë·∫øn Controller/Action c·ª• th·ªÉ)</div>
            <span class="arrow">‚¨áÔ∏è</span>
            <div class="stage">Action Method Th·ª±c Thi <br> (Code nghi·ªáp v·ª• c·ªßa b·∫°n ch·∫°y)</div>
            <span class="arrow">‚¨ÜÔ∏è</span>
            <div class="stage">Ph·∫£n h·ªìi (Response) ƒëi ng∆∞·ª£c qua Middleware</div>
            <span class="arrow">‚¨ÜÔ∏è</span>
            <div class="stage">Ph·∫£n h·ªìi HTTP v·ªÅ Client</div>
        </div>

        <h3>1.2. Gi·∫£i Th√≠ch Chi Ti·∫øt T·ª´ng Giai ƒêo·∫°n</h3>

        <h4>1.2.1. Kh·ªüi T·∫°o Host (File Program.cs)</h4>
        <p class="section-description">
            ƒê√¢y l√† "tr√°i tim" c·ªßa ·ª©ng d·ª•ng ASP.NET Core, n∆°i m·ªçi th·ª© b·∫Øt ƒë·∫ßu. Khi b·∫°n ch·∫°y ·ª©ng d·ª•ng, file <code>Program.cs</code> s·∫Ω ƒë∆∞·ª£c th·ª±c thi ƒë·∫ßu ti√™n. N√≥ gi·ªëng nh∆∞ vi·ªác b·∫°n kh·ªüi ƒë·ªông m·ªôt nh√† m√°y, chu·∫©n b·ªã c√°c m√°y m√≥c v√† d√¢y chuy·ªÅn s·∫£n xu·∫•t.
        </p>
        <ul>
            <li>
                <strong><code>var builder = WebApplication.CreateBuilder(args);</code></strong>: D√≤ng n√†y t·∫°o ra m·ªôt ƒë·ªëi t∆∞·ª£ng <code>WebApplicationBuilder</code>. ƒê·ªëi t∆∞·ª£ng n√†y l√† "ng∆∞·ªùi x√¢y d·ª±ng" gi√∫p b·∫°n c·∫•u h√¨nh m·ªçi th·ª© cho ·ª©ng d·ª•ng c·ªßa m√¨nh, t·ª´ vi·ªác ƒëƒÉng k√Ω c√°c d·ªãch v·ª• (services) ƒë·∫øn thi·∫øt l·∫≠p pipeline x·ª≠ l√Ω y√™u c·∫ßu (middleware).
            </li>
            <li>
                <strong>ƒêƒÉng k√Ω Services v√†o DI Container (<code>builder.Services...</code>)</strong>:
                <ul>
                    <li>
                        ASP.NET Core s·ª≠ d·ª•ng m·ªôt h·ªá th·ªëng g·ªçi l√† **Dependency Injection (DI)** (Ti√™m ph·ª• thu·ªôc). H√£y t∆∞·ªüng t∆∞·ª£ng b·∫°n c√≥ m·ªôt chi·∫øc xe (·ª©ng d·ª•ng c·ªßa b·∫°n) v√† n√≥ c·∫ßn b√°nh xe, ƒë·ªông c∆°, gh·∫ø ng·ªìi (c√°c service). Thay v√¨ chi·∫øc xe t·ª± ƒëi t√¨m v√† l·∫Øp r√°p t·ª´ng th·ª©, m·ªôt "nh√† m√°y" (DI Container) s·∫Ω cung c·∫•p v√† l·∫Øp s·∫µn nh·ªØng th·ª© ƒë√≥ cho chi·∫øc xe khi n√≥ ƒë∆∞·ª£c t·∫°o ra.
                    </li>
                    <li>
                        B·∫°n ƒëƒÉng k√Ω c√°c d·ªãch v·ª• (v√≠ d·ª•: d·ªãch v·ª• ƒë·ªçc ghi database, d·ªãch v·ª• g·ª≠i email, d·ªãch v·ª• ghi log) v√†o DI Container t·∫°i ƒë√¢y. ƒêi·ªÅu n√†y gi√∫p code c·ªßa b·∫°n **linh ho·∫°t h∆°n**, **d·ªÖ ki·ªÉm th·ª≠ h∆°n** v√† **√≠t ph·ª• thu·ªôc** v√†o nhau h∆°n.
                    </li>
                    <li>
                        B·∫°n c≈©ng c·∫•u h√¨nh **v√≤ng ƒë·ªùi (lifetime)** cho m·ªói service:
                        <ul>
                            <li>
                                <strong><span class="emoji">‚ú®</span> Transient (<code>builder.Services.AddTransient&lt;IMyService, MyService&gt;();</code>)</strong>: Gi·ªëng nh∆∞ m·ªôt c√°i ƒëƒ©a gi·∫•y d√πng m·ªôt l·∫ßn. M·ªói khi m·ªôt th√†nh ph·∫ßn (Controller, Service kh√°c) y√™u c·∫ßu service n√†y, m·ªôt **instance (th·ªÉ hi·ªán) m·ªõi ho√†n to√†n** s·∫Ω ƒë∆∞·ª£c t·∫°o ra.
                            </li>
                            <li>
                                <strong><span class="emoji">üîÑ</span> Scoped (<code>builder.Services.AddScoped&lt;IMyService, MyService&gt;();</code>)</strong>: Gi·ªëng nh∆∞ m·ªôt su·∫•t ƒÉn ƒë∆∞·ª£c ph·ª•c v·ª• ri√™ng cho m·ªói kh√°ch h√†ng. M·ªôt **instance duy nh·∫•t** ƒë∆∞·ª£c t·∫°o ra **cho m·ªói HTTP Request**. Trong su·ªët qu√° tr√¨nh x·ª≠ l√Ω c·ªßa m·ªôt y√™u c·∫ßu, t·∫•t c·∫£ c√°c th√†nh ph·∫ßn y√™u c·∫ßu service n√†y ƒë·ªÅu s·∫Ω nh·∫≠n ƒë∆∞·ª£c c√πng m·ªôt instance ƒë√≥. Khi request k·∫øt th√∫c, instance n√†y c≈©ng b·ªã h·ªßy. Th∆∞·ªùng d√πng cho database context.
                            </li>
                            <li>
                                <strong><span class="emoji">üëë</span> Singleton (<code>builder.Services.AddSingleton&lt;IMyService, MyService&gt;();</code>)</strong>: Gi·ªëng nh∆∞ m·ªôt t√≤a nh√† duy nh·∫•t. Ch·ªâ c√≥ **m·ªôt instance duy nh·∫•t** ƒë∆∞·ª£c t·∫°o ra **cho to√†n b·ªô v√≤ng ƒë·ªùi c·ªßa ·ª©ng d·ª•ng**. T·∫•t c·∫£ c√°c request v√† th√†nh ph·∫ßn ƒë·ªÅu chia s·∫ª c√πng m·ªôt instance n√†y. Th∆∞·ªùng d√πng cho c√°c d·ªãch v·ª• kh√¥ng gi·ªØ tr·∫°ng th√°i (stateless) v√† c·∫ßn hi·ªáu su·∫•t cao nh∆∞ caching ho·∫∑c logging.
                            </li>
                        </ul>
                    </li>
                    <li>
                        **C·∫•u h√¨nh CORS (<code>builder.Services.AddCors(...)</code>)**:
                        <ul>
                            <li>
                                **CORS** (Cross-Origin Resource Sharing) l√† m·ªôt c∆° ch·∫ø b·∫£o m·∫≠t tr√™n tr√¨nh duy·ªát web. N√≥ quy ƒë·ªãnh xem m·ªôt trang web (v√≠ d·ª•: website frontend c·ªßa b·∫°n ch·∫°y ·ªü `http://localhost:3000`) c√≥ ƒë∆∞·ª£c ph√©p truy c·∫≠p t√†i nguy√™n t·ª´ m·ªôt ngu·ªìn g·ªëc kh√°c (v√≠ d·ª•: API c·ªßa b·∫°n ch·∫°y ·ªü `https://localhost:5001`) hay kh√¥ng.
                            </li>
                            <li>
                                B·∫°n ƒë·ªãnh nghƒ©a "ch√≠nh s√°ch" CORS ·ªü ƒë√¢y, li·ªát k√™ nh·ªØng ngu·ªìn g·ªëc n√†o (t√™n mi·ªÅn/URL) ƒë∆∞·ª£c ph√©p truy c·∫≠p API c·ªßa b·∫°n, v√† ch√∫ng ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng c√°c ph∆∞∆°ng th·ª©c HTTP n√†o (GET, POST, PUT, DELETE) hay c√°c headers n√†o.
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li>
                <strong><code>var app = builder.Build();</code></strong>: Sau khi b·∫°n ƒë√£ "khai b√°o" v√† c·∫•u h√¨nh t·∫•t c·∫£ c√°c service, d√≤ng n√†y s·∫Ω x√¢y d·ª±ng ·ª©ng d·ª•ng web c·ªßa b·∫°n, s·∫µn s√†ng ƒë·ªÉ ƒë·ªãnh nghƒ©a c√°c b∆∞·ªõc x·ª≠ l√Ω y√™u c·∫ßu.
            </li>
            <li>
                **C·∫•u h√¨nh Middleware Pipeline (<code>app.Use...()</code>)**:
                <ul>
                    <li>
                        **Middleware** l√† c√°c th√†nh ph·∫ßn ph·∫ßn m·ªÅm nh·ªè ƒë∆∞·ª£c s·∫Øp x·∫øp theo m·ªôt th·ª© t·ª± nh·∫•t ƒë·ªãnh, t·∫°o th√†nh m·ªôt "ƒë∆∞·ªùng ·ªëng" (pipeline) x·ª≠ l√Ω y√™u c·∫ßu. Khi m·ªôt y√™u c·∫ßu HTTP ƒë·∫øn, n√≥ s·∫Ω ƒëi qua t·ª´ng Middleware m·ªôt. M·ªói Middleware c√≥ th·ªÉ th·ª±c hi·ªán m·ªôt t√°c v·ª• c·ª• th·ªÉ (v√≠ d·ª•: ghi log, x√°c th·ª±c, ·ªßy quy·ªÅn, n√©n d·ªØ li·ªáu) tr∆∞·ªõc khi chuy·ªÉn y√™u c·∫ßu cho Middleware ti·∫øp theo.
                    </li>
                    <li>
                        **Th·ª© t·ª± c·ªßa Middleware l√† C·ª∞C K·ª≤ QUAN TR·ªåNG!** N·∫øu b·∫°n ƒë·∫∑t sai th·ª© t·ª±, ·ª©ng d·ª•ng c·ªßa b·∫°n c√≥ th·ªÉ kh√¥ng ho·∫°t ƒë·ªông ƒë√∫ng ho·∫∑c g·∫∑p l·ªói b·∫£o m·∫≠t.
                    </li>
                </ul>
            </li>
            <li>
                **<code>app.Run();</code>**: ƒê√¢y l√† d√≤ng cu·ªëi c√πng trong file `Program.cs`, n√≥ kh·ªüi ƒë·ªông m√°y ch·ªß web (m·∫∑c ƒë·ªãnh l√† Kestrel) v√† b·∫Øt ƒë·∫ßu l·∫Øng nghe c√°c y√™u c·∫ßu HTTP ƒë·∫øn.
            </li>
        </ul>

        <div class="code-block">
            <pre><code><span class="comment">// Program.cs</span>
<span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);

<span class="comment">// --- ƒêƒÉng k√Ω Services v√†o DI Container ---</span>
builder.Services.<span class="highlight">AddControllers</span>(); <span class="comment">// Th√™m d·ªãch v·ª• cho ph√©p d√πng Controllers ƒë·ªÉ x·ª≠ l√Ω API</span>
builder.Services.<span class="highlight">AddEndpointsApiExplorer</span>(); <span class="comment">// H·ªó tr·ª£ Swagger ƒë·ªÉ t·∫°o t√†i li·ªáu API t·ª± ƒë·ªông</span>
builder.Services.<span class="highlight">AddSwaggerGen</span>(); <span class="comment">// ƒêƒÉng k√Ω Swagger ƒë·ªÉ hi·ªÉn th·ªã t√†i li·ªáu API</span>

<span class="comment">// --- C·∫•u h√¨nh CORS ---</span>
builder.Services.<span class="highlight">AddCors</span>(options =>
{
    options.<span class="highlight">AddDefaultPolicy</span>(
        policy =>
        {
            policy.<span class="highlight">WithOrigins</span>(<span class="string">"http://localhost:3000"</span>, <span class="string">"https://my-frontend-app.com"</span>) <span class="comment">// Cho ph√©p c√°c ngu·ªìn g·ªëc n√†y truy c·∫≠p</span>
                  .<span class="highlight">AllowAnyHeader</span>()    <span class="comment">// Cho ph√©p b·∫•t k·ª≥ header n√†o (Content-Type, Authorization, ...)</span>
                  .<span class="highlight">AllowAnyMethod</span>();   <span class="comment">// Cho ph√©p t·∫•t c·∫£ c√°c ph∆∞∆°ng th·ª©c HTTP (GET, POST, PUT, DELETE)</span>
        });
});

<span class="keyword">var</span> app = builder.<span class="highlight">Build</span>();

<span class="comment">// --- C·∫•u h√¨nh Middleware Pipeline ---</span>
<span class="comment">// Th·ª© t·ª± n√†y l√† khuy·∫øn ngh·ªã cho h·∫ßu h·∫øt c√°c ·ª©ng d·ª•ng Web API</span>
<span class="keyword">if</span> (app.Environment.<span class="highlight">IsDevelopment</span>()) <span class="comment">// Ch·ªâ b·∫≠t Swagger trong m√¥i tr∆∞·ªùng ph√°t tri·ªÉn</span>
{
    app.<span class="highlight">UseSwagger</span>();
    app.<span class="highlight">UseSwaggerUI</span>();
}

app.<span class="highlight">UseHttpsRedirection</span>(); <span class="comment">// T·ª± ƒë·ªông chuy·ªÉn h∆∞·ªõng y√™u c·∫ßu t·ª´ HTTP sang HTTPS (quan tr·ªçng cho b·∫£o m·∫≠t)</span>

app.<span class="highlight">UseRouting</span>(); <span class="comment">// Middleware n√†y quy·∫øt ƒë·ªãnh Request s·∫Ω ƒëi ƒë·∫øn "ƒë∆∞·ªùng" n√†o (URL n√†o)</span>

app.<span class="highlight">UseCors</span>(); <span class="comment">// Middleware n√†y √°p d·ª•ng ch√≠nh s√°ch CORS ƒë√£ c·∫•u h√¨nh. PH·∫¢I SAU UseRouting()!</span>

app.<span class="highlight">UseAuthentication</span>(); <span class="comment">// Middleware n√†y x√°c ƒë·ªãnh danh t√≠nh ng∆∞·ªùi d√πng (ƒëƒÉng nh·∫≠p)</span>
app.<span class="highlight">UseAuthorization</span>();  <span class="comment">// Middleware n√†y ki·ªÉm tra quy·ªÅn c·ªßa ng∆∞·ªùi d√πng ƒë√£ x√°c ƒë·ªãnh</span>

app.<span class="highlight">MapControllers</span>(); <span class="comment">// Middleware n√†y "k·∫øt n·ªëi" Request v·ªõi c√°c Action Method trong Controller c·ªßa b·∫°n</span>

app.<span class="highlight">Run</span>(); <span class="comment">// Ch·∫°y ·ª©ng d·ª•ng v√† l·∫Øng nghe c√°c Request
</code></pre>
        </div>
        <div class="note">
            <strong>T·∫ßm quan tr·ªçng c·ªßa Th·ª© t·ª± Middleware:</strong> <br>
            H√£y nh·ªõ r·∫±ng th·ª© t·ª± c√°c <code>app.Use...()</code> trong <code>Program.cs</code> l√† c·ª±c k·ª≥ quan tr·ªçng. M·ªói middleware s·∫Ω x·ª≠ l√Ω request v√† truy·ªÅn n√≥ cho middleware ti·∫øp theo. N·∫øu sai th·ª© t·ª±, c√°c t√≠nh nƒÉng nh∆∞ CORS, x√°c th·ª±c ho·∫∑c ·ªßy quy·ªÅn c√≥ th·ªÉ kh√¥ng ho·∫°t ƒë·ªông ƒë√∫ng. V√≠ d·ª•, b·∫°n c·∫ßn bi·∫øt request ƒëi ƒë√¢u (<code>UseRouting</code>) tr∆∞·ªõc khi √°p d·ª•ng CORS cho endpoint ƒë√≥ (<code>UseCors</code>).
        </div>

        <h4>1.2.2. Middleware Pipeline (X·ª≠ l√Ω Request th·ª±c t·∫ø)</h4>
        <p class="section-description">
            Sau khi ·ª©ng d·ª•ng kh·ªüi ƒë·ªông, b·∫•t k·ª≥ y√™u c·∫ßu HTTP n√†o ƒë·∫øn s·∫Ω ƒëi qua "ƒë∆∞·ªùng ·ªëng" c√°c Middleware n√†y. H√£y c√πng ƒëi chi ti·∫øt qua t·ª´ng ƒëi·ªÉm d·ª´ng:
        </p>
        <ul>
            <li>
                <strong>Client G·ª≠i HTTP Request</strong>: M·ªçi chuy·ªán b·∫Øt ƒë·∫ßu khi m·ªôt tr√¨nh duy·ªát ho·∫∑c m·ªôt ·ª©ng d·ª•ng kh√°c g·ª≠i m·ªôt y√™u c·∫ßu (v√≠ d·ª•: `GET /api/products`).
            </li>
            <li>
                <strong>Kestrel/IIS (Server) Nh·∫≠n Request</strong>: Kestrel (m√°y ch·ªß web m·∫∑c ƒë·ªãnh c·ªßa ASP.NET Core) ho·∫∑c IIS (n·∫øu b·∫°n tri·ªÉn khai tr√™n Windows Server) nh·∫≠n y√™u c·∫ßu th√¥ n√†y.
            </li>
            <li>
                <strong>UseHttpsRedirection()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: N·∫øu request ƒë·∫øn l√† `http://` (kh√¥ng b·∫£o m·∫≠t), middleware n√†y s·∫Ω t·ª± ƒë·ªông chuy·ªÉn h∆∞·ªõng n√≥ sang `https://` (c√≥ b·∫£o m·∫≠t).
                    </li>
                    <li>
                        **T·∫°i sao quan tr·ªçng**: Lu√¥n s·ª≠ d·ª•ng HTTPS ƒë·ªÉ b·∫£o v·ªá d·ªØ li·ªáu truy·ªÅn t·∫£i gi·ªØa client v√† server.
                    </li>
                </ul>
            </li>
            <li>
                <strong>UseRouting()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: "Ng∆∞·ªùi ƒë·ªãnh v·ªã ƒë∆∞·ªùng ƒëi". N√≥ ƒë·ªçc URL c·ªßa request v√† t√¨m ra "ƒë√≠ch ƒë·∫øn" cu·ªëi c√πng c·ªßa request ƒë√≥ trong ·ª©ng d·ª•ng c·ªßa b·∫°n (v√≠ d·ª•: n√≥ bi·∫øt `GET /api/products` n√™n ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi ph∆∞∆°ng th·ª©c `GetAllProducts` trong `ProductsController`).
                    </li>
                    <li>
                        **T·∫°i sao quan tr·ªçng**: L√† b∆∞·ªõc ƒë·∫ßu ti√™n ƒë·ªÉ h·ªá th·ªëng bi·∫øt request n√†y d√†nh cho Controller/Action n√†o.
                    </li>
                </ul>
            </li>
            <li>
                <strong>UseCors()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: "Ng∆∞·ªùi ki·ªÉm so√°t bi√™n gi·ªõi". Sau khi `UseRouting()` ƒë√£ t√¨m ra ƒë√≠ch ƒë·∫øn, `UseCors()` ki·ªÉm tra xem ngu·ªìn g·ªëc (origin) c·ªßa y√™u c·∫ßu (t·ª©c l√† trang web g·ª≠i y√™u c·∫ßu) c√≥ ƒë∆∞·ª£c ph√©p truy c·∫≠p t√†i nguy√™n n√†y hay kh√¥ng d·ª±a tr√™n c√°c ch√≠nh s√°ch b·∫°n ƒë√£ c·∫•u h√¨nh.
                    </li>
                    <li>
                        **T·∫°i sao quan tr·ªçng**: NgƒÉn ch·∫∑n c√°c y√™u c·∫ßu ƒë·ªôc h·∫°i t·ª´ c√°c trang web kh√¥ng mong mu·ªën, b·∫£o v·ªá API c·ªßa b·∫°n.
                    </li>
                </ul>
            </li>
            <li>
                <strong>UseAuthentication()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: "Ng∆∞·ªùi ki·ªÉm tra danh t√≠nh". Middleware n√†y c·ªë g·∫Øng x√°c ƒë·ªãnh "b·∫°n l√† ai". N√≥ ki·ªÉm tra c√°c th√¥ng tin nh∆∞ token (JWT Token), cookie, ho·∫∑c th√¥ng tin ƒëƒÉng nh·∫≠p kh√°c ƒë·ªÉ bi·∫øt ng∆∞·ªùi d√πng hi·ªán t·∫°i l√† ai.
                    </li>
                    <li>
                        **T·∫°i sao quan tr·ªçng**: ƒê·ªÉ bi·∫øt request ƒë∆∞·ª£c g·ª≠i b·ªüi m·ªôt ng∆∞·ªùi d√πng h·ª£p l·ªá hay kh√¥ng.
                    </li>
                </ul>
            </li>
            <li>
                <strong>UseAuthorization()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: "Ng∆∞·ªùi ki·ªÉm tra quy·ªÅn". Sau khi ƒë√£ x√°c ƒë·ªãnh ƒë∆∞·ª£c "b·∫°n l√† ai" (`UseAuthentication`), middleware n√†y ki·ªÉm tra xem "b·∫°n c√≥ quy·ªÅn l√†m ƒëi·ªÅu ƒë√≥ kh√¥ng?". V√≠ d·ª•, ng∆∞·ªùi d√πng A c√≥ th·ªÉ xem danh s√°ch s·∫£n ph·∫©m, nh∆∞ng ch·ªâ ng∆∞·ªùi qu·∫£n tr·ªã m·ªõi c√≥ th·ªÉ x√≥a s·∫£n ph·∫©m.
                    </li>
                    <li>
                        **T·∫°i sao quan tr·ªçng**: ƒê·∫£m b·∫£o ng∆∞·ªùi d√πng ch·ªâ truy c·∫≠p ƒë∆∞·ª£c nh·ªØng g√¨ h·ªç ƒë∆∞·ª£c ph√©p.
                    </li>
                </ul>
            </li>
            <li>
                <strong>MapControllers()</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: "K√≠ch ho·∫°t h√†nh ƒë·ªông". ƒê√¢y l√† b∆∞·ªõc m√† h·ªá th·ªëng th·ª±c s·ª± g·ªçi ƒë·∫øn ph∆∞∆°ng th·ª©c (Action Method) trong Controller c·ªßa b·∫°n m√† `UseRouting()` ƒë√£ t√¨m th·∫•y.
                    </li>
                </ul>
            </li>
            <li>
                <strong>Action Method Th·ª±c Thi</strong>:
                <ul>
                    <li>
                        **Nhi·ªám v·ª•**: ƒê√¢y l√† n∆°i code nghi·ªáp v·ª• c·ªßa b·∫°n ch·∫°y. Controller nh·∫≠n request, x·ª≠ l√Ω d·ªØ li·ªáu, c√≥ th·ªÉ g·ªçi c√°c service kh√°c (ƒë√£ ƒë∆∞·ª£c inject b·ªüi DI container) ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi database, th·ª±c hi·ªán t√≠nh to√°n, v.v.
                    </li>
                    <li>
                        **K·∫øt qu·∫£**: Sau khi x·ª≠ l√Ω, Action Method s·∫Ω tr·∫£ v·ªÅ m·ªôt k·∫øt qu·∫£, th∆∞·ªùng l√† d·ªØ li·ªáu (JSON) v√† m·ªôt HTTP status code (v√≠ d·ª•: 200 OK, 404 Not Found, 201 Created).
                    </li>
                </ul>
            </li>
            <li>
                <strong>Ph·∫£n h·ªìi (Response) ƒëi ng∆∞·ª£c l·∫°i qua Middleware</strong>: K·∫øt qu·∫£ t·ª´ Action Method s·∫Ω ƒëi ng∆∞·ª£c l·∫°i qua c√°c Middleware trong pipeline (theo th·ª© t·ª± ng∆∞·ª£c l·∫°i). C√°c Middleware n√†y c√≥ th·ªÉ th√™m c√°c header, n√©n d·ªØ li·ªáu, ho·∫∑c th·ª±c hi·ªán c√°c t√°c v·ª• kh√°c tr∆∞·ªõc khi ph·∫£n h·ªìi ƒë∆∞·ª£c g·ª≠i ƒëi.
            </li>
            <li>
                <strong>Ph·∫£n h·ªìi HTTP v·ªÅ Client</strong>: Cu·ªëi c√πng, ph·∫£n h·ªìi ho√†n ch·ªânh ƒë∆∞·ª£c g·ª≠i tr·ªü l·∫°i tr√¨nh duy·ªát ho·∫∑c ·ª©ng d·ª•ng ƒë√£ g·ª≠i y√™u c·∫ßu.
            </li>
        </ul>

        ---

        <h2>Ph·∫ßn 2: H∆∞·ªõng D·∫´n Chi Ti·∫øt C√°ch T·∫°o M·ªôt Web API "Fake"</h2>
        <p class="section-description">
            ƒê·ªÉ b·∫°n d·ªÖ h√¨nh dung, ch√∫ng ta s·∫Ω t·∫°o m·ªôt Web API ƒë∆°n gi·∫£n ƒë·ªÉ qu·∫£n l√Ω "S·∫£n ph·∫©m" (Products) v·ªõi 4 ph∆∞∆°ng th·ª©c chu·∫©n c·ªßa RESTful API: GET, POST, PUT, DELETE. API n√†y s·∫Ω kh√¥ng d√πng database th·ª±c t·∫ø m√† ch·ªâ l∆∞u d·ªØ li·ªáu trong b·ªô nh·ªõ (m·ªôt danh s√°ch `List<Product>`) ƒë·ªÉ ƒë∆°n gi·∫£n.
        </p>

        <h3>2.1. C√†i ƒê·∫∑t M√¥i Tr∆∞·ªùng</h3>
        <p class="section-description">
            Tr∆∞·ªõc ti√™n, b·∫°n c·∫ßn c√†i ƒë·∫∑t:
            <ul>
                <li><strong>.NET SDK:</strong> T·∫£i v√† c√†i ƒë·∫∑t t·ª´ <a href="https://dotnet.microsoft.com/download" target="_blank">trang ch·ªß Microsoft</a>.</li>
                <li><strong>Visual Studio Code</strong> (khuy√™n d√πng) ho·∫∑c <strong>Visual Studio Community</strong> (b·∫£n mi·ªÖn ph√≠): T·∫£i t·ª´ <a href="https://code.visualstudio.com/" target="_blank">trang ch·ªß VS Code</a> ho·∫∑c <a href="https://visualstudio.microsoft.com/vs/community/" target="_blank">trang ch·ªß Visual Studio</a>.</li>
            </ul>
        </p>

        <h3>2.2. T·∫°o Project Web API M·ªõi</h3>
        <p class="section-description">
            M·ªü **Terminal** (tr√™n macOS/Linux) ho·∫∑c **Command Prompt/PowerShell** (tr√™n Windows) v√† l√†m theo c√°c b∆∞·ªõc sau:
        </p>
        <div class="step-by-step">
            <div class="step">
                <strong>B∆∞·ªõc 1: T·∫°o th∆∞ m·ª•c cho d·ª± √°n</strong>
                <div class="code-block">
                    <pre><code>mkdir MyFakeProductApi
cd MyFakeProductApi</code></pre>
                </div>
            </div>
            <div class="step">
                <strong>B∆∞·ªõc 2: T·∫°o d·ª± √°n Web API</strong>
                <p>S·ª≠ d·ª•ng l·ªánh sau ƒë·ªÉ t·∫°o m·ªôt d·ª± √°n ASP.NET Core Web API m·ªõi. L·ªánh n√†y s·∫Ω t·∫°o ra m·ªôt c·∫•u tr√∫c th∆∞ m·ª•c v√† c√°c file c·∫ßn thi·∫øt.</p>
                <div class="code-block">
                    <pre><code>dotnet new webapi -n MyFakeProductApi</code></pre>
                </div>
                <p>N·∫øu b·∫°n mu·ªën s·ª≠ d·ª•ng Controller thay v√¨ Minimal API m·∫∑c ƒë·ªãnh (t·ª´ .NET 6 tr·ªü l√™n), b·∫°n c√≥ th·ªÉ th√™m `--no-minimal-apis`.</p>
                <div class="code-block">
                    <pre><code>dotnet new webapi -n MyFakeProductApi --no-minimal-apis</code></pre>
            </div>
            </div>
            <div class="step">
                <strong>B∆∞·ªõc 3: M·ªü d·ª± √°n trong Visual Studio Code</strong>
                <p>Sau khi t·∫°o, b·∫°n c√≥ th·ªÉ m·ªü d·ª± √°n b·∫±ng VS Code:</p>
                <div class="code-block">
                    <pre><code>code .</code></pre>
                </div>
            </div>
        </div>

        <h3>2.3. C·∫•u Tr√∫c D·ª± √Ån C∆° B·∫£n</h3>
        <p class="section-description">
            Khi b·∫°n m·ªü d·ª± √°n, b·∫°n s·∫Ω th·∫•y c√°c file v√† th∆∞ m·ª•c ch√≠nh:
            <ul>
                <li><strong><code>Program.cs</code>:</strong> File kh·ªüi ƒë·ªông ·ª©ng d·ª•ng (ƒë√£ gi·∫£i th√≠ch ·ªü Ph·∫ßn 1).</li>
                <li><strong><code>Controllers/</code>:</strong> Th∆∞ m·ª•c ch·ª©a c√°c API Controller c·ªßa b·∫°n.</li>
                <li><strong><code>Properties/launchSettings.json</code>:</strong> C·∫•u h√¨nh c√°ch ·ª©ng d·ª•ng ch·∫°y trong m√¥i tr∆∞·ªùng ph√°t tri·ªÉn (c√°c c·ªïng, profile).</li>
                <li><strong><code>appsettings.json</code>:</strong> File c·∫•u h√¨nh ·ª©ng d·ª•ng.</li>
            </ul>
        </p>

        <h3>2.4. T·∫°o Model (ƒê·ªëi T∆∞·ª£ng D·ªØ Li·ªáu)</h3>
        <p class="section-description">
            Ch√∫ng ta s·∫Ω t·∫°o m·ªôt l·ªõp (class) `Product` ƒë·ªÉ ƒë·∫°i di·ªán cho m·ªôt s·∫£n ph·∫©m.
        </p>
        <div class="step-by-step">
            <div class="step">
                <strong>B∆∞·ªõc 1: T·∫°o th∆∞ m·ª•c <code>Models</code></strong>
                <p>Trong th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n, t·∫°o m·ªôt th∆∞ m·ª•c m·ªõi t√™n l√† <code>Models</code>.</p>
            </div>
            <div class="step">
                <strong>B∆∞·ªõc 2: T·∫°o file <code>Product.cs</code></strong>
                <p>Trong th∆∞ m·ª•c <code>Models</code>, t·∫°o m·ªôt file m·ªõi t√™n l√† <code>Product.cs</code> v√† th√™m n·ªôi dung sau:</p>
                <div class="code-block">
                    <pre><code><span class="comment">// Models/Product.cs</span>
<span class="keyword">namespace</span> MyFakeProductApi.Models
{
    <span class="keyword">public class</span> Product
    {
        <span class="keyword">public int</span> Id { <span class="keyword">get</span>; <span class="keyword">set</span>; }
        <span class="keyword">public string</span> Name { <span class="keyword">get</span>; <span class="keyword">set</span>; } = <span class="string">string</span>.Empty;
        <span class="keyword">public decimal</span> Price { <span class="keyword">get</span>; <span class="keyword">set</span>; }
        <span class="keyword">public string</span> Description { <span class="keyword">get</span>; <span class="keyword">set</span>; } = <span class="string">string</span>.Empty;
    }
}
                    </code></pre>
                </div>
            </div>
        </div>

        <h3>2.5. T·∫°o Controller (API Logic)</h3>
        <p class="section-description">
            Controller l√† n∆°i b·∫°n ƒë·ªãnh nghƒ©a c√°c ph∆∞∆°ng th·ª©c (Action Methods) s·∫Ω x·ª≠ l√Ω c√°c y√™u c·∫ßu HTTP (GET, POST, PUT, DELETE).
        </p>
        <div class="step-by-step">
            <div class="step">
                <strong>B∆∞·ªõc 1: X√≥a Controller m·∫∑c ƒë·ªãnh (t√πy ch·ªçn)</strong>
                <p>ASP.NET Core th∆∞·ªùng t·∫°o s·∫µn m·ªôt <code>WeatherForecastController.cs</code>. B·∫°n c√≥ th·ªÉ x√≥a file n√†y n·∫øu mu·ªën.</p>
            </div>
            <div class="step">
                <strong>B∆∞·ªõc 2: T·∫°o file <code>ProductsController.cs</code></strong>
                <p>Trong th∆∞ m·ª•c <code>Controllers</code>, t·∫°o m·ªôt file m·ªõi t√™n l√† <code>ProductsController.cs</code> v√† th√™m n·ªôi dung sau:</p>
                <div class="code-block">
                    <pre><code><span class="comment">// Controllers/ProductsController.cs</span>
<span class="keyword">using</span> Microsoft.AspNetCore.Mvc;
<span class="keyword">using</span> MyFakeProductApi.Models; <span class="comment">// Nh·ªõ th√™m using ƒë·ªÉ s·ª≠ d·ª•ng l·ªõp Product</span>
<span class="keyword">using</span> System.Collections.Generic;
<span class="keyword">using</span> System.Linq;

[ApiController] <span class="comment">// ƒê√°nh d·∫•u ƒë√¢y l√† m·ªôt API Controller</span>
[Route(<span class="string">"api/[controller]"</span>)] <span class="comment">// ƒê·ªãnh nghƒ©a route c∆° b·∫£n: /api/Products</span>
<span class="keyword">public class</span> ProductsController : ControllerBase
{
    <span class="comment">// D·ªØ li·ªáu "gi·∫£" l∆∞u trong b·ªô nh·ªõ. Trong ·ª©ng d·ª•ng th·ª±c, ƒë√¢y s·∫Ω l√† database.</span>
    <span class="keyword">private static</span> List&lt;Product&gt; _products = <span class="keyword">new</span> List&lt;Product&gt;
    {
        <span class="keyword">new</span> Product { Id = <span class="number">1</span>, Name = <span class="string">"Laptop XYZ"</span>, Price = <span class="number">1200m</span>, Description = <span class="string">"Powerful laptop for coding."</span> },
        <span class="keyword">new</span> Product { Id = <span class="number">2</span>, Name = <span class="string">"Mouse Ergonomic"</span>, Price = <span class="number">25m</span>, Description = <span class="string">"Comfortable mouse for long use."</span> },
        <span class="keyword">new</span> Product { Id = <span class="number">3</span>, Name = <span class="string">"USB-C Hub"</span>, Price = <span class="number">50m</span>, Description = <span class="string">"Multi-port adapter for modern laptops."</span> }
    };

    <span class="comment">// --- 1. GET: L·∫•y t·∫•t c·∫£ s·∫£n ph·∫©m ---</span>
    <span class="comment">// Route: GET /api/products</span>
    [HttpGet]
    <span class="keyword">public</span> ActionResult&lt;IEnumerable&lt;Product&gt;&gt; GetAllProducts()
    {
        <span class="comment">// Tr·∫£ v·ªÅ danh s√°ch t·∫•t c·∫£ s·∫£n ph·∫©m v·ªõi HTTP 200 OK</span>
        <span class="keyword">return</span> Ok(_products);
    }

    <span class="comment">// --- 2. GET: L·∫•y s·∫£n ph·∫©m theo ID ---</span>
    <span class="comment">// Route: GET /api/products/{id}</span>
    [HttpGet(<span class="string">"{id}"</span>)] <span class="comment">// {id} l√† tham s·ªë trong URL</span>
    <span class="keyword">public</span> ActionResult&lt;Product&gt; GetProductById(<span class="keyword">int</span> id)
    {
        <span class="keyword">var</span> product = _products.FirstOrDefault(p => p.Id == id);
        <span class="keyword">if</span> (product == <span class="keyword">null</span>)
        {
            <span class="comment">// N·∫øu kh√¥ng t√¨m th·∫•y, tr·∫£ v·ªÅ HTTP 404 Not Found</span>
            <span class="keyword">return</span> NotFound();
        }
        <span class="comment">// T√¨m th·∫•y, tr·∫£ v·ªÅ s·∫£n ph·∫©m v·ªõi HTTP 200 OK</span>
        <span class="keyword">return</span> Ok(product);
    }

    <span class="comment">// --- 3. POST: Th√™m s·∫£n ph·∫©m m·ªõi ---</span>
    <span class="comment">// Route: POST /api/products</span>
    [HttpPost]
    <span class="keyword">public</span> ActionResult&lt;Product&gt; CreateProduct([FromBody] Product newProduct)
    {
        <span class="comment">// ƒê·∫∑t ID m·ªõi (ƒë∆°n gi·∫£n, trong th·ª±c t·∫ø d√πng ID t·ª± tƒÉng t·ª´ DB)</span>
        newProduct.Id = _products.Any() ? _products.Max(p => p.Id) + <span class="number">1</span> : <span class="number">1</span>;
        _products.Add(newProduct);
        <span class="comment">// Tr·∫£ v·ªÅ HTTP 201 Created v√† URL ƒë·ªÉ l·∫•y s·∫£n ph·∫©m v·ª´a t·∫°o</span>
        <span class="keyword">return</span> CreatedAtAction(nameof(GetProductById), <span class="keyword">new</span> { id = newProduct.Id }, newProduct);
    }

    <span class="comment">// --- 4. PUT: C·∫≠p nh·∫≠t s·∫£n ph·∫©m hi·ªán c√≥ ---</span>
    <span class="comment">// Route: PUT /api/products/{id}</span>
    [HttpPut(<span class="string">"{id}"</span>)]
    <span class="keyword">public</span> IActionResult UpdateProduct(<span class="keyword">int</span> id, [FromBody] Product updatedProduct)
    {
        <span class="keyword">if</span> (id != updatedProduct.Id)
        {
            <span class="comment">// ID trong URL kh√¥ng kh·ªõp ID trong body, tr·∫£ v·ªÅ HTTP 400 Bad Request</span>
            <span class="keyword">return</span> BadRequest();
        }

        <span class="keyword">var</span> existingProduct = _products.FirstOrDefault(p => p.Id == id);
        <span class="keyword">if</span> (existingProduct == <span class="keyword">null</span>)
        {
            <span class="comment">// Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ƒë·ªÉ c·∫≠p nh·∫≠t, tr·∫£ v·ªÅ HTTP 404 Not Found</span>
            <span class="keyword">return</span> NotFound();
        }

        <span class="comment">// C·∫≠p nh·∫≠t th√¥ng tin s·∫£n ph·∫©m</span>
        existingProduct.Name = updatedProduct.Name;
        existingProduct.Price = updatedProduct.Price;
        existingProduct.Description = updatedProduct.Description;

        <span class="comment">// C·∫≠p nh·∫≠t th√†nh c√¥ng nh∆∞ng kh√¥ng c·∫ßn tr·∫£ v·ªÅ n·ªôi dung, HTTP 204 No Content</span>
        <span class="keyword">return</span> NoContent();
    }

    <span class="comment">// --- 5. DELETE: X√≥a s·∫£n ph·∫©m ---</span>
    <span class="comment">// Route: DELETE /api/products/{id}</span>
    [HttpDelete(<span class="string">"{id}"</span>)]
    <span class="keyword">public</span> IActionResult DeleteProduct(<span class="keyword">int</span> id)
    {
        <span class="keyword">var</span> productToRemove = _products.FirstOrDefault(p => p.Id == id);
        <span class="keyword">if</span> (productToRemove == <span class="keyword">null</span>)
        {
            <span class="comment">// Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ƒë·ªÉ x√≥a, tr·∫£ v·ªÅ HTTP 404 Not Found</span>
            <span class="keyword">return</span> NotFound();
        }

        _products.Remove(productToRemove);
        <span class="comment">// X√≥a th√†nh c√¥ng, HTTP 204 No Content</span>
        <span class="keyword">return</span> NoContent();
    }
}
                    </code></pre>
                </div>
            </div>
        </div>

        <h3>2.6. Ch·ªânh S·ª≠a `Program.cs` (n·∫øu b·∫°n t·∫°o `--no-minimal-apis`)</h3>
        <p class="section-description">
            N·∫øu b·∫°n t·∫°o project v·ªõi option `--no-minimal-apis`, file <code>Program.cs</code> s·∫Ω t∆∞∆°ng t·ª± nh∆∞ m·∫´u ·ªü Ph·∫ßn 1. Ch·ªâ c·∫ßn ƒë·∫£m b·∫£o d√≤ng <code>builder.Services.AddControllers();</code> v√† <code>app.MapControllers();</code> ƒë√£ c√≥ s·∫µn.
        </p>

        <h3>2.7. Ch·∫°y ·ª®ng D·ª•ng API c·ªßa B·∫°n</h3>
        <p class="section-description">
            Sau khi ƒë√£ t·∫°o Model v√† Controller, b·∫°n c√≥ th·ªÉ ch·∫°y API c·ªßa m√¨nh:
        </p>
        <div class="step-by-step">
            <div class="step">
                <strong>B∆∞·ªõc 1: Ch·∫°y t·ª´ Terminal</strong>
                <p>Trong th∆∞ m·ª•c g·ªëc c·ªßa d·ª± √°n (<code>MyFakeProductApi</code>), ch·∫°y l·ªánh:</p>
                <div class="code-block">
                    <pre><code>dotnet run</code></pre>
                </div>
                <p>B·∫°n s·∫Ω th·∫•y c√°c URL m√† API c·ªßa b·∫°n ƒëang l·∫Øng nghe (th∆∞·ªùng l√† `http://localhost:5xxx` v√† `https://localhost:7xxx`).</p>
            </div>
            <div class="step">
                <strong>B∆∞·ªõc 2: Test API c·ªßa b·∫°n</strong>
                <p>B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c c√¥ng c·ª• nh∆∞ tr√¨nh duy·ªát web, Postman, Insomnia, ho·∫∑c ti·ªán √≠ch `REST Client` c·ªßa VS Code ƒë·ªÉ test.</p>
                <div class="rest-methods">
                    <div class="method-box get">
                        <h4>GET All Products</h4>
                        <p><strong>URL:</strong> <code>https://localhost:7xxx/api/products</code> (thay 7xxx b·∫±ng s·ªë c·ªïng c·ªßa b·∫°n)<br>
                        <strong>Method:</strong> <code>GET</code><br>
                        <strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> Danh s√°ch t·∫•t c·∫£ s·∫£n ph·∫©m.</p>
                    </div>
                    <div class="method-box get">
                        <h4>GET Product By ID</h4>
                        <p><strong>URL:</strong> <code>https://localhost:7xxx/api/products/1</code><br>
                        <strong>Method:</strong> <code>GET</code><br>
                        <strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> S·∫£n ph·∫©m c√≥ ID l√† 1 (ho·∫∑c 404 n·∫øu kh√¥ng t√¨m th·∫•y).</p>
                    </div>
                    <div class="method-box post">
                        <h4>POST Create Product</h4>
                        <p><strong>URL:</strong> <code>https://localhost:7xxx/api/products</code><br>
                        <strong>Method:</strong> <code>POST</code><br>
                        <strong>Header:</strong> <code>Content-Type: application/json</code><br>
                        <strong>Body (JSON):</strong>
                        <div class="code-block" style="background: #3a3f47; border-left: 5px solid #FFC107;">
                            <pre><code>{
  "name": "Mechanical Keyboard",
  "price": 150,
  "description": "High-quality keyboard with tactile keys."
}</code></pre>
                        </div>
                        <strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> HTTP 201 Created v√† chi ti·∫øt s·∫£n ph·∫©m m·ªõi.</p>
                    </div>
                    <div class="method-box put">
                        <h4>PUT Update Product</h4>
                        <p><strong>URL:</strong> <code>https://localhost:7xxx/api/products/1</code><br>
                        <strong>Method:</strong> <code>PUT</code><br>
                        <strong>Header:</strong> <code>Content-Type: application/json</code><br>
                        <strong>Body (JSON):</strong>
                        <div class="code-block" style="background: #3a3f47; border-left: 5px solid #9C27B0;">
                            <pre><code>{
  "id": 1,
  "name": "Laptop XYZ (Updated)",
  "price": 1250,
  "description": "Powerful laptop, now with better battery."
}</code></pre>
                        </div>
                        <strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> HTTP 204 No Content (c·∫≠p nh·∫≠t th√†nh c√¥ng).</p>
                    </div>
                    <div class="method-box delete">
                        <h4>DELETE Product</h4>
                        <p><strong>URL:</strong> <code>https://localhost:7xxx/api/products/1</code><br>
                        <strong>Method:</strong> <code>DELETE</code><br>
                        <strong>K·∫øt qu·∫£ mong ƒë·ª£i:</strong> HTTP 204 No Content (x√≥a th√†nh c√¥ng).</p>
                    </div>
                </div>
            </div>
        </div>

        ---

        <h2>Ph·∫ßn 3: CORS (Cross-Origin Resource Sharing) v√† t·∫ßm quan tr·ªçng</h2>
        <p class="section-description">
            Nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p ·ªü tr√™n, CORS l√† m·ªôt c∆° ch·∫ø b·∫£o m·∫≠t tr√¨nh duy·ªát. N·∫øu b·∫°n ƒë·ªãnh x√¢y d·ª±ng m·ªôt ·ª©ng d·ª•ng frontend (v√≠ d·ª•: d√πng React, Angular, Vue) ch·∫°y tr√™n m·ªôt ƒë·ªãa ch·ªâ kh√°c v·ªõi API c·ªßa b·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói CORS n·∫øu kh√¥ng c·∫•u h√¨nh ƒë√∫ng.
        </p>
        <p class="section-description">
            **T√¨nh hu·ªëng ph·ªï bi·∫øn:**
            <ul>
                <li>API c·ªßa b·∫°n ch·∫°y tr√™n `https://localhost:7000`</li>
                <li>Frontend c·ªßa b·∫°n ch·∫°y tr√™n `http://localhost:3000`</li>
            </ul>
            Khi frontend c·ªë g·∫Øng g·ª≠i request ƒë·∫øn API, tr√¨nh duy·ªát s·∫Ω ch·∫∑n request ƒë√≥ v√¨ ch√∫ng c√≥ "ngu·ªìn g·ªëc" kh√°c nhau (kh√°c protocol, host, ho·∫∑c port). ƒê√¢y l√† l√∫c CORS c·∫ßn thi·∫øt.
        </p>
        <div class="code-block">
            <pre><code><span class="comment">// Trong Program.cs, trong ph·∫ßn builder.Services</span>
builder.Services.<span class="highlight">AddCors</span>(options =>
{
    options.<span class="highlight">AddDefaultPolicy</span>(
        policy =>
        {
            policy.<span class="highlight">WithOrigins</span>(<span class="string">"http://localhost:3000"</span>) <span class="comment">// Th√™m ngu·ªìn g·ªëc c·ªßa frontend c·ªßa b·∫°n</span>
                  .<span class="highlight">AllowAnyHeader</span>()
                  .<span class="highlight">AllowAnyMethod</span>();
        });
});

<span class="comment">// ... v√† trong ph·∫ßn app.Use...()</span>
app.<span class="highlight">UseRouting</span>();
app.<span class="highlight">UseCors</span>(); <span class="comment">// √Åp d·ª•ng ch√≠nh s√°ch CORS sau Routing</span>
app.<span class="highlight">UseAuthorization</span>(); <span class="comment">// C√°c middleware kh√°c</span>
</code></pre>
        </div>
        <p class="section-description">
            V·ªõi c·∫•u h√¨nh tr√™n, tr√¨nh duy·ªát s·∫Ω cho ph√©p frontend c·ªßa b·∫°n (`http://localhost:3000`) g·ªçi ƒë·∫øn API.
        </p>
        <div class="note">
            <strong>C·∫£nh b√°o B·∫£o m·∫≠t:</strong> <br>
            Khi tri·ªÉn khai l√™n m√¥i tr∆∞·ªùng th·ª±c (production), kh√¥ng n√™n s·ª≠ d·ª•ng <code>.AllowAnyOrigin()</code>, tr·ª´ khi b·∫°n hi·ªÉu r√µ r·ªßi ro b·∫£o m·∫≠t. Lu√¥n ch·ªâ ƒë·ªãnh r√µ r√†ng c√°c <code>WithOrigins()</code> m√† b·∫°n tin t∆∞·ªüng.
        </div>

        <p class="section-description">
            Ch√∫c m·ª´ng! B·∫°n ƒë√£ ho√†n th√†nh m·ªôt tour du l·ªãch chi ti·∫øt v·ªÅ v√≤ng ƒë·ªùi c·ªßa ASP.NET Core Web API v√† x√¢y d·ª±ng ƒë∆∞·ª£c API "fake" ƒë·∫ßu ti√™n c·ªßa m√¨nh. H√£y ti·∫øp t·ª•c kh√°m ph√° v√† x√¢y d·ª±ng nh√©!
        </p>
    </div>
</body>
</html>